<!doctype html>
<html data-n-head="lang" data-n-head-ssr lang="ja">
  <head>
    <meta data-n-head="true" charset="utf-8"><meta data-n-head="true" content="width=device-width,initial-scale=1" name="viewport"><meta data-n-head="true" content="Naochael Jordan Blog. ReactNative, Electron, Nuxt.js, Vuex, Redux, Rails辺りをよく触ってます。" name="description" data-hid="description"><meta data-n-head="true" content="yes" name="mobile-web-app-capable" data-hid="mobile-web-app-capable"><meta data-n-head="true" content="Naochael Jordan" name="apple-mobile-web-app-title" data-hid="apple-mobile-web-app-title"><meta data-n-head="true" content="#3B8070" name="theme-color" data-hid="theme-color"><meta data-n-head="true" content="website" name="og:type" data-hid="og:type" property="og:type"><meta data-n-head="true" content="Naochael Jordan" name="og:title" data-hid="og:title" property="og:title"><meta data-n-head="true" content="Naochael Jordan" name="og:site_name" data-hid="og:site_name" property="og:site_name"><meta data-n-head="true" content="- Nuxt.js + TypeScript + Markdown - git pushしたらTravisでGithub Pagesデプロイして、完了したらSlackで通知" name="og:description" data-hid="og:description" property="og:description"><title data-n-head="true">Naochael Jordan Blog</title><link href="/blog/favicon.ico" rel="icon" data-n-head="true" type="image/x-icon"><link href="/blog/apple-touch-icon-iphone.png" rel="apple-touch-icon" data-n-head="true"><link href="/blog/_nuxt/manifest.ff15a448.json" rel="manifest" data-n-head="true"><link href="/blog/_nuxt/icons/icon_64.9F4oh08j8qj.png" rel="shortcut icon" data-n-head="true"><base href="/blog/"><link href="/blog/_nuxt/manifest.a5f9e150dfee106cb667.js" rel="preload" as="script"><link href="/blog/_nuxt/vendor.9cd260a929ef240cc3c9.js" rel="preload" as="script"><link href="/blog/_nuxt/app.2d8371c12659f68c8806.js" rel="preload" as="script"><link href="/blog/_nuxt/layouts/default.39f41fc80a7ca63b733a.js" rel="preload" as="script"><link href="/blog/_nuxt/pages/_slug.30db68fcf5770890f38f.js" rel="preload" as="script"><link href="/blog/_nuxt/pages/profile.55da638f84c59ee63447.js" rel="prefetch"><link href="/blog/_nuxt/pages/index.85ce95f18f314cbf8fe1.js" rel="prefetch"><style data-vue-ssr-id="72e7ad30:0">/*! normalize.css v8.0.0 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}h1{font-size:2em;margin:.67em 0}hr{-webkit-box-sizing:content-box;box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{-webkit-box-sizing:border-box;box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{-webkit-box-sizing:border-box;box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden],template{display:none}</style><style data-vue-ssr-id="d9c5482a:0">:root{font-size:10px}body{-webkit-font-smoothing:subpixel-antialiased;-moz-osx-font-smoothing:unset;font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Yu Gothic,YuGothic,Verdana,Meiryo,sans-serif;font-size:16px;font-size:1.6rem;line-height:1.8;color:#1d2129;word-wrap:break-word}@media (-webkit-min-device-pixel-ratio:2),(min-resolution:2dppx),only screen and (-webkit-min-device-pixel-ratio:2){body{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}}a{color:#365899;text-decoration:none;-webkit-tap-highlight-color:transparent}a:hover{text-decoration:underline}img{vertical-align:bottom}</style><style data-vue-ssr-id="16b151f4:0">.hljs{display:block;overflow-x:auto;padding:.5em;background:#1e1e1e;color:#dcdcdc}.hljs-keyword,.hljs-link,.hljs-literal,.hljs-name,.hljs-symbol{color:#569cd6}.hljs-link{text-decoration:underline}.hljs-built_in,.hljs-type{color:#4ec9b0}.hljs-class,.hljs-number{color:#b8d7a3}.hljs-meta-string,.hljs-string{color:#d69d85}.hljs-regexp,.hljs-template-tag{color:#9a5334}.hljs-formula,.hljs-function,.hljs-params,.hljs-subst,.hljs-title{color:#dcdcdc}.hljs-comment,.hljs-quote{color:#57a64a;font-style:italic}.hljs-doctag{color:#608b4e}.hljs-meta,.hljs-meta-keyword,.hljs-tag{color:#9b9b9b}.hljs-template-variable,.hljs-variable{color:#bd63c5}.hljs-attr,.hljs-attribute,.hljs-builtin-name{color:#9cdcfe}.hljs-section{color:gold}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-bullet,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-selector-tag{color:#d7ba7d}.hljs-addition{background-color:#144212}.hljs-addition,.hljs-deletion{display:inline-block;width:100%}.hljs-deletion{background-color:#600}</style><style data-vue-ssr-id="f2455208:0">.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;-webkit-transition:width .2s,opacity .4s;transition:width .2s,opacity .4s;opacity:1;background-color:#efc14e;z-index:999999}</style><style data-vue-ssr-id="3306b9e2:0"></style><style data-vue-ssr-id="7a2af22e:0">header[data-v-1a9bb128]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;padding:10px 20px 10px 10px;color:#fff;background:#333;border-bottom:1px solid #000}header a[data-v-1a9bb128]{color:#fff}header h1[data-v-1a9bb128]{margin:0;font-size:25.6px;font-size:1.6rem;font-weight:400;line-height:1.2}header h1 a[data-v-1a9bb128]:hover{text-decoration:none}header h1 span[data-v-1a9bb128]{margin-right:4px;font-weight:700}header ul[data-v-1a9bb128]{display:-webkit-box;display:-ms-flexbox;display:flex;margin:0;padding:0;font-size:22.4px;font-size:1.4rem;list-style-type:none}header li[data-v-1a9bb128]{margin-left:20px}@media (max-width:900px){header h1 span[data-v-1a9bb128]{display:block}header li[data-v-1a9bb128]{margin-left:8px}}</style><style data-vue-ssr-id="b2785a20:0">.container[data-v-286199e1]{max-width:880px;margin:50px auto}.container h1[data-v-286199e1]{font-size:67.2px;font-size:4.2rem;line-height:91.2px;line-height:5.7rem;font-weight:600}.container .date[data-v-286199e1]{text-align:right}.container .contents[data-v-286199e1]{margin-bottom:40px;color:#4b4f56}.container .contents[data-v-286199e1] h1{margin:60px 0 10px;padding-bottom:10px;font-size:41.6px;font-size:2.6rem;line-height:67.2px;line-height:4.2rem;border-bottom:1px solid #efefef}.container .contents[data-v-286199e1] h2{margin:40px 0 0;font-size:32px;font-size:2rem;line-height:48px;line-height:3rem}.container .contents[data-v-286199e1] li{margin-bottom:4px}.container .contents[data-v-286199e1] img{display:inline-block;margin-top:20px;margin-bottom:20px}.container .contents[data-v-286199e1] p{margin:20px 0 4px}.container .contents[data-v-286199e1] a{text-decoration:underline}.container .contents[data-v-286199e1] p code,.container .contents[data-v-286199e1] ul code{margin:0 4px;color:#ca454e}.container .contents[data-v-286199e1] .hljs{padding:1em 24px;background-color:#364549}.container .sns[data-v-286199e1]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.container .twitter[data-v-286199e1]{margin-right:10px}@media (max-width:900px){.container[data-v-286199e1]{margin:20px auto;padding:0 16px}.container h1[data-v-286199e1]{margin:0 0 10px;font-size:2.2rem;line-height:3rem}.container .date[data-v-286199e1]{margin:0;font-size:1.3rem}.container .contents[data-v-286199e1]{line-height:1.6}.container .contents[data-v-286199e1] h1{margin:40px 0 0;padding-bottom:6px;font-size:2rem;line-height:3rem;border-bottom:1px solid #efefef}.container .contents[data-v-286199e1] h2{margin:30px 0 0;font-size:1.6rem;line-height:2.2rem}.container .contents[data-v-286199e1] img{width:100%}.container .contents[data-v-286199e1] p{margin-top:12px}.container .contents[data-v-286199e1] p code{white-space:normal}.container .contents[data-v-286199e1] ul{margin-top:6px;padding-left:30px}.container .contents[data-v-286199e1] li{margin-bottom:4px}.container .contents[data-v-286199e1] pre{overflow:auto;word-wrap:normal;white-space:pre;-webkit-overflow-scrolling:touch;overflow-scrolling:touch;margin:12px -16px}.container .contents[data-v-286199e1] .hljs{padding:1em 16px;-webkit-text-size-adjust:none}}</style><style data-vue-ssr-id="7d6d2817:0">footer[data-v-0d2d6594]{padding:10px 0;color:#fff;font-size:14px;background:#333}footer .container[data-v-0d2d6594]{max-width:880px;margin:0 auto}footer h2[data-v-0d2d6594]{margin:0 0 20px;padding-top:20px;font-size:38.4px;font-size:2.4rem}footer .md-large[data-v-0d2d6594]{width:160px;height:160px;border-radius:160px}footer .box[data-v-0d2d6594]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:20px}footer .profile[data-v-0d2d6594]{border-radius:50%}footer .info[data-v-0d2d6594]{-webkit-box-flex:1;-ms-flex:1;flex:1;margin-left:20px}footer .info ul[data-v-0d2d6594]{margin:20px 0 0;padding:0;list-style-type:none}footer .info li[data-v-0d2d6594]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:10px}footer .info li a[data-v-0d2d6594]{margin-right:10px;color:#fff}footer .info .more[data-v-0d2d6594]{margin-left:4px;color:#fff;text-decoration:underline}footer address[data-v-0d2d6594]{margin:0;text-align:center}@media (max-width:900px){footer[data-v-0d2d6594]{padding:10px}footer h2[data-v-0d2d6594]{margin:10px 0;padding:0;font-size:1.8rem;line-height:1.4}footer .box[data-v-0d2d6594]{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}footer .profile[data-v-0d2d6594]{width:100px;height:100px}footer .info[data-v-0d2d6594]{margin-left:16px;line-height:1.4}footer h3[data-v-0d2d6594]{margin:0 0 10px;font-size:1.6rem}footer p[data-v-0d2d6594]{margin:0 0 10px;font-size:1.3rem}footer ul[data-v-0d2d6594]{font-size:1.2rem}footer address[data-v-0d2d6594]{line-height:1.6}}</style>
  </head>
  <body data-n-head="">
    <div id="__nuxt" data-server-rendered="true"><div class="nuxt-progress" style="width:0%;height:2px;background-color:#3b8070;opacity:0"></div><div id="__layout"><div class="container" data-v-314f53c6><header data-v-1a9bb128 data-v-314f53c6></header><div class="contents" data-v-314f53c6><div class="container" data-v-314f53c6 data-v-286199e1></div></div><footer data-v-0d2d6594 data-v-314f53c6></footer></div></div></div><script type="text/javascript">window.__NUXT__={layout:"default",data:[{}],error:null,state:{posts:[{attributes:{title:"モチベーションを保つ方法",date:"2018-12-14T00:00:00.000Z"},body:"\nもう何度経験したことか。\n超やる気!!な状態から、なぜかしばらく経つと、超やる気でない!!な状態になることを。\n\nそんな超やる気!!な状態を少しでも長い時間持てたら、自分の人生は更に向上するはず。そんな想いで自分にとってのモチベーションを保つ方法をまとめる。\n\n# 1分でいいからやるべきタスクに手を付ける\n\nこれは最大で最重要かもしれない。\n要は少しでも手をつけてみるってことだ。\n眠い時もやる気でない時もどんな時もだ。\nそうすると不思議と1分でやる気が出てくる、眠気が飛ぶ。\nなのでやる気でない!!な時は、これをまずはやってみる。\n\n# 新しい動画を5分見る\n\nこれは新しいってのが重要かも。\n要は自分の興味のある分野の、でもまだ見た事ない動画を見るとそれだけでモチベーションが上がってくるのだ。\n例えば最初は胡散臭さを感じていたこの動画。[https://www.youtube.com/channel/UCcCl0ZR7omH6pwHEwTqEsoQ](https://www.youtube.com/channel/UCcCl0ZR7omH6pwHEwTqEsoQ)\nこれが自分には合ってた。\n見たら面白くて納得でモチベーションも上がってくる。\n別に情報商材買うとかセミナー行くとかしなくていい。\n動画を見てモチベーションを頂いて自分の為に励む、これだけのためだ。\n\n# 興味のある本の目次だけを見る\n\n自分の興味のある分野の本の目次だけをさっと眺めて、読みたいところだけをとりあえず読んでみる。\nするとそこから火がついて集中力が増してくる。\n\n# 少しでいいので運動をする\n\n運動と勉強は密接に関連しているそうだ。\n勉強だけやっていてもガリ勉の脳になるだけでビジネスに役立つ頭にはならないらしい。逆に運動ばかりやってもだめ。\nどっちもやるってのが大事。なので少しでもいいので運動する事が大事。\n\n# まとめ\n\nこの辺りをやるとだいたい人間の脳はやる気が湧いてくる。\n一気にやる気マックス！！にはならないだろうが、徐々に上がってくる感じ。\nそれと人間の脳は簡単な方、怠る方に動こうとするものだと知る事も大事。それを知ってる事でそれがやってきた時にそれを経つ事ができる。何も考えてないとただ流されて生きた行くことになる。\n",frontmatter:"title: モチベーションを保つ方法\ndate: 2018-12-14",fileName:"2018-12-14-motivation-up-tips"},{attributes:{title:"ReactNative + FirestoreでiOSの環境構築",date:"2018-12-09T00:00:00.000Z"},body:"\nReactNative + Firestoreの環境構築を進めていたけど、結構ハマりポイントがあったので忘れないうちに備忘録。\n\n基本的には下記の公式ドキュメントを元に進めていく。\n[https://rnfirebase.io/docs/v5.x.x/installation/initial-setup](https://rnfirebase.io/docs/v5.x.x/installation/initial-setup)\n\nまずはプロジェクトの作成から\n```bash\nreact-native init hogehoge\ncd hogehoge\n```\n\n必要なモジュールをインストール\n```bash\nyarn add react-native-firebase\n```\n\nここから`GoogleService-Info.plist`を入れたり、ソースの修正が必要なので、Xcodeを立ち上げる。\n```bash\nopen ios/{PROJECT_NAME}.xcodeproj\n```\n\nFirebaseでプロジェクトを作って、 `GoogleService-Info.plist` をダウンロード。\nこの辺りは、[ドキュメントを参照](https://rnfirebase.io/docs/v5.x.x/installation/initial-setup)してダウンロードまで進める。\n\nそれと、Firestoreを使うので、ブラウザのFirestore上で最初の使いますボタンのポチ、だけは終わらせとく。\n\n`GoogleService-Info.plist`がダウンロード出来たら、それをXcodeのプロジェクト内にドラッグして入れる。\nその際にリファレンス付けるポップアップが出るので、リファレンス付きで入れるようにする。\n\n直接Finderなどから`ios`直下に入れてもダメで、ちゃんとドラッグしてリファレンス付きで入れる必要がある。\nちゃんと入ってないとrun-iosした時にアプリが立ち上がってすぐにエラー画面もなくクラッシュする。\n\t\nまたXcodeのBundleIDをGoogleService-info.plistのBundleIDと合わせる。\n合わせなくてもrun-iosは走るが、たぶん最終的にXcodeでビルドする時はエラーになる。\n\n次にXcode上の`AppDelegate.m`を開いて、先頭に下記を追加。先頭と言ってもファイルの先頭である必要はない。他の`#import`の下とかで良い。\n```\n#import <Firebase.h>\n```\n\nそれと、`didFinishLaunchingWithOptions:(NSDictionary *)launchOptions`メソッドの下に以下を追加する\n```\n[FIRApp configure];\n```\n\nこれでXcodeは閉じて良い。\n\n次に、ターミナル上で、`Podfile`を生成する\n```\ncd ios\npod init\n```\n\n`Podfile`されるので下記のように編集する。\n```bash\nplatform :ios, '9.0' # ここのコメントを外す\n\npod 'Firebase/Core'\n\n# これはコメントアウトしないとpod install出来ない\n# target 'rnf9-tvOSTests' do\n#   inherit! :search_paths\n#   # Pods for testing\n# end\n```\n\n※注意点\n通常なら、`pod 'Firebase/Firestore'`を`pod 'Firebase/Core'`の下とかに書いて一緒に入れたいけど、なぜかCoreと一緒にインストールすると、run-ios時にエラーが出て動かない。まずCoreを入れてlinkしてFirebaseの構築が出来た後にFirestoreを入れる手順だと無事動いた。\n\nその時のエラー文(は？って感じだ。)↓\n**RNFirebase core module was not found natively on iOS, ensure you have correctly included the RNFirebase pod in your projects `Podfile` and have run `pod install`.**\n\n上の`Podfile`の修正が終わったら\n```\npod install\n```\n\nreact-native-firebaseをlinkする\n```bash\ncd ../\nreact-native link react-native-firebase\n```\n\nlinkが終わったタイミングで、`Podfile`にFirestoreを書き足す。\n```bash\npod 'Firebase/Firestore'\n```\n\nもうFirestoreをインストール\n```\npod install\n```\n\nこれで動くはずなので、App.jsに以下を追加。\n```js\nimport firebase from \"react-native-firebase\";\n\nfirebase\n  .firestore()\n  .collection(\"hoge\")\n  .add({\n    value: '入ってーーー',\n  });\n```\n\nちゃんと使えるかチェックする。\n```bash\nreact-native run-ios\n```\n\nエラーなく初期画面が立ち上がって、更新するたびにFirestoreにデータが格納されていけば成功。\n\n# まとめ\nFirestoreをpod installするタイミングとかが結構、謎でCoreと一緒のタイミングで入れたいけどダメだった。\nGoogleService-info.plistもディレクトリに単に放り込めば良い的なものを見たが、Xcodeから入れないとダメだった。\n結構、はてなが付く事が多いが、これで開発進められるはず..!\n",frontmatter:"title: ReactNative + FirestoreでiOSの環境構築\ndate: 2018-12-09",fileName:"2018-12-09-react-native-firestore"},{attributes:{title:"AWS Lambda + Puppeteerでダイナミックレンダリングする",date:"2018-11-30T00:00:00.000Z"},body:'\n基本的には下記のサイトが非常に参考になった。\n[SSRをやめる。OGP対応はLambda@Edgeでダイナミックレンダリングする。](https://qiita.com/geerpm/items/78e2b85dca3cb698e98d)\n\nこの記事ではPuppeteerは使っていないが、Puppeteerで目的のダイナミックレンダリングが出来そうだったのでやってみた。\n\n基本的に上記のやり方を参考に進めて、キモであるダイナミックレンダリングするところだけ、Puppeteerを使うように変更した。今回は主にその部分の備忘録。ServerlessもWebpackも使っていない。\n\n# 全体の流れ\n\nまずはざっくりとした全体の流れから。\n1. **html, css, jsとかのアセットをS3に配置して静的ホスティングする**\n1. **そのS3をCloudFront経由で配信する**\n1. **LambdaのViewer RequestでUserAgentからボットの判別をして、ボットだったらカスタムヘッダーを付与する**\n1. **LambdaのOrigin Requestでボット用のカスタムヘッダーが付いてたらPuppeteerでダイナミックレンダリングする**\n\nViewer RequestやOrigin RequestなどのLambda@Edgeのライフサイクルイベントについては、[公式](https://docs.aws.amazon.com/ja_jp/lambda/latest/dg/lambda-edge.html)がわかりやすい。\n\n以下、CloudFrontで配信するのが終わったあとのところから。\n\n# LambdaのViewer RequestでUserAgentからボットの判別をして、ボットだったらカスタムヘッダーを付与する\n\nほとんど参考記事のままだが、下記のようなViewer Request Functionを準備して、Lambda上のエディタにペーストしてデプロイ。\nやっているのは、UserAgentがクローラーで、かつhtmlへのリクエストだったらダイナミックレンダリング用のカスタムヘッダーをつける、という感じ。\n```js\n"use strict";\n\nexports.handler = (event, context, callback) => {\n  const request = event.Records[0].cf.request;\n  const headers = request.headers;\n  \n  const crawlers = [\n    "Googlebot",\n    "facebookexternalhit",\n    "Twitterbot",\n    "bingbot",\n    "msnbot"\n  ];\n\n  const excludeExtentions = [\n    "jpg",\n    "png",\n    "gif",\n    "jpeg",\n    "svg",\n    "css",\n    "js",\n    "json",\n    "txt",\n    "ico",\n    "map"\n  ];\n\n  const dynamicRenderHeaderName = "X-Need-Dynamic-Render";\n\n  const extention =\n    request.uri === null || request.uri === "/"\n      ? ""\n      : request.uri\n          .split(".")\n          .pop()\n          .toLowerCase();\n  const maybeHtml = !excludeExtentions.some(e => e === extention);\n\n  const isCrawler = crawlers.some(c => {\n    return headers["user-agent"][0].value.includes(c);\n  });\n\n  // UserAgentがクローラーで、かつhtmlへのリクエストだったらカスタムヘッダーをつける\n  if (isCrawler && maybeHtml) {\n    request.headers[dynamicRenderHeaderName.toLowerCase()] = [\n      {\n        key: dynamicRenderHeaderName,\n        value: "true"\n      }\n    ];\n  }\n\n  callback(null, request);\n};\n```\n\n# LambdaのOrigin Requestでボット用のカスタムヘッダーが付いてたらPuppeteerでダイナミックレンダリングする\n\nここの流れとしては、\n1. **npm initしてpackage.jsonを生成**\n1. **Puppeteerとか必要なモジュールをnpm install**\n1. **Puppeteerを使ってダイナミックレンダリングの処理を書く**\n1. **実装が終わったら、node_modulesとかも含めてzip圧縮してLambda上からzipでアップロードして、デプロイする**\n\nという感じ。\n\nServerlessを使うとzip化してデプロイの作業が効率化出来るので実案件とかだと使った方が良さそうか。\n\nローカルの作業場所はどこでも良いので、おもむろに `npm init -y` とかでpackage.jsonを生成する。\nそして必要なモジュールを`npm install`していく\n```json\n"dependencies": {\n  "@serverless-chrome/lambda": "^1.0.0-55",\n  "chrome-remote-interface": "^0.27.0",\n  "puppeteer-core": "^1.11.0"\n}\n```\n\n`puppeteer-core`じゃなくて`puppeteer`を普通に`npm install`すると、Chromiumも一緒にダウンロードしてしまって、そうなるとLambdaの50MBの制限に容易に引っかかってしまう。\nなのでPuppeteer1.7以降から追加された、`puppeteer-core`をインストールするようにする。\n\nインストール出来たら実際にPuppeteerを使ってダイナミックレンダリングの実装を`index.js`に書いていく。\n```js\n"use strict";\n\nconst launchChrome = require("@serverless-chrome/lambda");\nconst CDP = require("chrome-remote-interface");\nconst puppeteer = require("puppeteer-core");\n\nexports.handler = async (event, context, callback) => {\n  const dynamicRenderHeaderName = "X-Need-Dynamic-Render";\n  const request = event.Records[0].cf.request;\n  const headers = request.headers;\n\n  // クローラーじゃなかったら何もしない\n  if (!headers[dynamicRenderHeaderName.toLowerCase()]) return callback(null, request);\n\n  // クローラーだったら、ダイナミックレンダリングする\n  let slsChrome = null;\n  let browser = null;\n  let page = null;\n\n  try {\n    // Chromeの立ち上げ\n    slsChrome = await launchChrome();\n\n    // WebSocketを使ってPuppeteerと繋げる\n    browser = await puppeteer.connect({\n      browserWSEndpoint: (await CDP.Version()).webSocketDebuggerUrl\n    });\n\n    page = await browser.newPage();\n    await page.goto("https://ダイナミックレンダリングしたいURL/", {\n      waitUntil: "networkidle0"\n    });\n    const html = await page.content();\n\n    await browser.close();\n    await slsChrome.kill();\n\n    const response = {\n      status: "200",\n      statusDescription: "OK",\n      headers: {\n        "cache-control": [\n          {\n            key: "Cache-Control",\n            value: "max-age=100"\n          }\n        ],\n        "content-type": [\n          {\n            key: "Content-Type",\n            value: "text/html"\n          }\n        ],\n        "content-encoding": [\n          {\n            key: "Content-Encoding",\n            value: "UTF-8"\n          }\n        ]\n      },\n      body: html.replace("<html", \'<html style="background: #ff0;"\') // 試しにボットの時だけ背景色を黄色に変えてみる\n    };\n\n    return callback(null, response);\n  } catch (err) {\n    return callback(err);\n  }\n};\n```\n\nこんな感じに。\nボットの時に元のコンテンツに変化がないと、ちゃんとダイナミックレンダリングされてるか分からないので、`<html style="background: #ff0;">`を入れて全体が黄色になればOKという感じにした。\n\nこれが出来たら`node_modules`や`package.json`、`index.js`など含めてzip化する。\nそのzipをLambdaにアップロードしてデプロイする。\n\n# 注意点\n\n## Finderの右クリックでzip化してしまうとLambdaで動かした時にエラーが出てしまう\n\nzip化はコマンドで行うと問題なかった。\npackage.jsonのある場所で、`zip -r app.zip * `とかでzipにする。\n\n\n## Origin Requestの設定\n\nOrigin Requestのデフォルトの設定だと、WebSocketでPuppeteerとconnectするところでタイムアウトエラーになってしまった。\n\n色々試したところ、どうもLambdaの管理画面上で設定できる、メモリとタイムアウトまでの時間を変更する必要があった。\nデフォルトのマシンの性能だと非力すぎて、タイムアウトまでに処理が出来ない、ということのようだ。\n\nデフォルトの設定から\nメモリ 128MB → 512MB\nタイムアウト 3秒 → 30秒\nに変えたところエラーが消えて、無事にPuppeteerがLambda上で動いた。\n\n<img src="./images/2018-11-30/lambda.png" width="100%">\n\n# 動作確認\n\n動作確認は、ChromeのDevToolsの`Network conditions`から`Googlebot`をチェックしてサイトにアクセスすることで確認出来る。\nボットの時に黄色のページが表示されて、ボットじゃない時は元のページが表示されればOK。\n\n<img src="./images/2018-11-30/pc.png" width="100%">\n\n[モバイルフレンドリーテスト](https://search.google.com/test/mobile-friendly?hl=ja)もOK\n\n<img src="./images/2018-11-30/friendly.png" width="100%">\n\n[Fetch as Google](https://support.google.com/webmasters/answer/6066468?hl=ja)も問題なさそう。\n<img src="./images/2018-11-30/fetch.png" width="100%">\n\n# まとめ\nLambda + Puppeteerでダイナミックレンダリングが出来た。\nLambdaの仕組みからよく分かってなかったのでキャッチアップしながら進めて、内容的にもそこまで難しくもないだろうと思っていたが、Lambdaの50MBの制限やメモリを上げないといけなかった事とかハマるポイントはあった。\n実際は`LambdaでPuppeteerを動す`が出来たらあとはhtml取得して返すだけなので、動かすところまでがキモになりそう。\n\nおしまい。\n',frontmatter:"title: AWS Lambda + Puppeteerでダイナミックレンダリングする\ndate: 2018-11-30",fileName:"2018-11-30-lambda-puppeteer-dynamic-rendering"},{attributes:{title:"React NativeでiOSとAndroidのアプリのアイコンを変更する",date:"2018-11-23T00:00:00.000Z"},body:'\nReactNativeというわけではないけど、iOSとAndroidのアプリのアイコンをデフォルト画像から自前で準備したアイコンに設定する時のメモ。と言っても驚くほど簡単だった。\n\n# アプリのアイコン画像を準備する\n\nまずは画像の準備から。\nアイコンサイズは `1024 x 1024` で準備しとく。\n\n<img src="./images/2018-11-23/icon.png" width="20%">\n\nたぶんPhotoshopやXDを使って作成すると、サイズ別で書き出しが出来ると思うけど、それらが無い場合はそれぞれのサイズに書き出してくれるWebサービスを使っても出来そう。パッと試したい時とか。\n\n使ったのは下記のサービス\n[App Icon Resizer](https://resizeappicon.com/)\n\nここに画像をアップロードすると、iOS,Androidに必要なアイコンをサイズ別でダウンロードすることが出来る。これらをダウンロードして手元に持っておく。\n\n# iOSでアプリのアイコンを設定する\n\niOSの場合はXCodeからアイコン設定出来る\nXcodeでプロジェクトを開く(`/ios/hoge.xcodeproj`をXcodeで開く)\n\n下記のキャプチャのように `images.xcassets` → `AppIcon` をクリックすると、サイズ別にアプリアイコンが設定出来るので、そこに画像をドラッグ&ドロップで格納していく。\n\n<img src="./images/2018-11-23/xcode.png" width="50%">\n\nこれで`react-native run-ios`して、シミュレーター上でもアイコンが変更されてたらOK!\n\n<img src="./images/2018-11-23/iphone.png" width="50%">\n\n# Andoirdでアプリのアイコンを設定する\n\nAndroid側はAndroid Studioは使わない。ディレクトリに画像を入れるのみ。入れる場所は、`/android/app/src/main/res/`の直下に、\n`mipmap-mdpi`\n`mipmap-hdpi`\n`mipmap-xhdpi`\n`mipmap-xxhdpi`\n`mipmap-xxxhdpi`\nのサイズ別のディレクトリがあって、すでにデフォルトのアプリアイコンの画像が格納されているので、そこの画像を差し替えする。\n\n画像サイズは下記のように格納する\n`mdpi → 48 x 48`\n`hdpi → 72 x 72`\n`xhdpi → 96 x 96`\n`xxhdpi → 144 x 144`\n`xxxhdpi → 192 x 192`\n\nこの`mipmap-mdpi`などのディレクトリ名と`ic_launcher.png`のファイル名は変更出来て、`android/app/src/main/AndroidManifest.xml`の`android:icon="@mipmap/ic_launcher"`で管理されている。\n\nまたAndroid7.1からはアプリアイコンに丸いアイコンが追加されて`AndroidManifest.xml`で従来のアイコンの他に`android:roundIcon="@mipmap/ic_launcher_round"`を指定しておくと、対応デバイスで丸いアイコンが表示されるようになったもよう。\n\n差し替えた状態で`react-native run-android`してシミュレーター上でもアプリアイコンが変わっていたらOK!\n\n<img src="./images/2018-11-23/android.png" width="50%">\n\nシミュレーターでうまくいってたら実機側も問題なくアイコン画像変わってた! おしまい。\n',frontmatter:"title: React NativeでiOSとAndroidのアプリのアイコンを変更する\ndate: 2018-11-23",fileName:"2018-11-23-react-native-change-app-icon"},{attributes:{title:"React Native v0.57以降のTypeScript環境構築",date:"2018-11-12T00:00:00.000Z"},body:'\nReactNative v0.57以降はTypeScriptがデフォルトから書けるということでやってみたら確かに出来たので、構築方法の備忘録。\nhttps://qiita.com/Nkzn/items/cf1516136d2db981fbb9\n\nまずはReactNativeプロジェクトをinitで作成。\n```bash\nreact-native init react-native-typescript\n```\n\n必要なnode_modulesをインストール\n```bash\nyarn add --dev typescript @types/react @types/react-native\n```\n\ntsconfig.jsonの雛形を作成\n```bash\nyarn tsc --init --pretty --jsx react\n```\n\ntsconfig.jsonの`"allowSyntheticDefaultImports": true,`のコメントアウトを外す\n\n以上で完了なので、iosを立ち上げてみる。\n\n```bash\nreact-native run-ios\n```\n\n<img src="./images/2018-11-12/iphone3.png" width="50%">\n\n完了!\n',frontmatter:"title: React Native v0.57以降のTypeScript環境構築\ndate: 2018-11-12",fileName:"2018-11-12-react-native-typescript"},{attributes:{title:"React Nativeで起きたエラーと解決策",date:"2018-11-04T00:00:00.000Z"},body:'\nReact Nativeの開発で起きたエラーと解決策のまとめ\n\n# Print: Entry, “:CFBundleIdentifier”, Does Not Existのエラー\n\n`react-native init hogehoge` して\n`react-native run-ios`した時に出たエラー\n”:CFBundleIdentifier”が見つからないもよう\n\n## 解決策\n`/ios/プロジェクト名.xcodeproj`をXcodeで開いて、File → Project Settingsのメニューの中から「Advanced」を選択して、下記のように設定すると良かった。\n\n<img src="./images/2018-11-04/xcode.png" width="80%">\n\nもしくは別の解決策で、\n```bash\nnpm i -g react-native-git-upgrade\nreact-native-git-upgrade\n```\nでも直った。\n※さらに、`react-native upgrade`でも直るっぽいけど、`react-native-git-upgrade`が公式にも載ってるupgradeの方法のようで、`react-native upgrade`は[iOS全体の設定を上書きするような記載](https://stackoverflow.com/a/37505341)もあるのでやらない方が吉なのかも。\n\n### 参考\nhttps://www.haneca.net/react-native-cfbundleidentifier-error/\nhttps://stackoverflow.com/questions/37461703/print-entry-cfbundleidentifier-does-not-exist\n\n# Couldn\'t find preset "module:metro-react-native-babel-preset"のエラー\n\n`yarn test` や`react-native upgrade`した時に下記のようなエラーが出た\n```\nCouldn\'t find preset "module:metro-react-native-babel-preset" relative to directory "/Users/naochael/Desktop/git/naochael-jordan/sandpit/ReactNative/rnt4"\n```\n\n## 解決策\nbabel6 → babel7への橋渡しが必要なようで、\n`yarn add --dev babel-core@^7.0.0-bridge.0 @babel/core` して\n`.babelrc` → `babel.config.js` にリネームして、\n```\nmodule.exports = function(api) {\n  api.cache(true);\n\n  return {\n    presets: ["module:metro-react-native-babel-preset"]\n  };\n};\n```\nを記述すると無事テストも通るようになった\n\n`babel.config.js`は[babel自身](https://github.com/babel/babel/blob/master/babel.config.js)も使っていて、`.babelrc`より推奨されてるみたい。でもなぜ`react-native init`した時のデフォルトが`.babelrc`なのかは分からない。\n\n### 参考\nhttps://github.com/facebook/react-native/issues/21241#issuecomment-431464191\n',frontmatter:"title: React Nativeで起きたエラーと解決策\ndate: 2018-11-04",fileName:"2018-11-04-react-native-error"},{attributes:{title:"GraphQL + RailsでDBからデータ取得までのメモ",date:"2018-11-02T00:00:00.000Z"},body:'\nGraphQL + Railsな環境で、\nDBの`users`テーブルの中の`id`と`email`を`GraphiQL`上で取得するところまでのメモ\n\n最終的に\n[http://localhost:3000/graphiql](http://localhost:3000/graphiql)\nにアクセスして、下記のクエリを実行して、\n```\nquery {\n  user {\n    id\n    email\n  }\n}\n```\n\n下記になったらゴールのところまで \n```\n{\n  "data": {\n    "user": {\n      "id": 1,\n      "email": "hoge@example.com"\n    }\n  }\n}\n```\n\nまずはrailsプロジェクトを作成\n```bash\nrails new graphql-rails-example\n```\n\nDB作成\n```bash\nrails db:create\n```\n\n`Gemfile`に`\'graphql\'`を追加(これを書いてる時の最新バージョンは1.8.10)\n※2018年5月ぐらいのバージョン1.8+から[Class-Based API](http://graphql-ruby.org/schema/class_based_api)に変わり実装が変わって、\n昔の`.define-style`な書き方だとエラー出ちゃうので、`Class-Based API`で実装していく\n```ruby\ngem \'graphql\', \'~> 1.8.10\'\n```\n\nインストール\n```bash\nbundle\n```\n\n`graphql`は最初の雛形を作る便利なgenerateがあるので、\nそれを使ってもろもろ必要なファイルを生成(`Class-Based API`ベースなファイルが生成される)\n```bash\nrails g graphql:install\n```\n\nこれで必要なファイルが生成されるのと同時に、`Gemfile`に`gem \'graphiql-rails\', group: :development`が追加されて\n`GraphiQL`っていうブラウザ上でGraphQLのqueryとかmutationとかを叩いて試せるGUIが操作出来るようになるので、それをインストール\n```bash\nbundle\n```\n\nローカルサーバーの立ち上げ\n```bash\nrails s\n```\n\n[http://localhost:3000/graphiql](http://localhost:3000/graphiql)\nにアクセスして、下記のqueryを実行\n`testField`が取れるか確認する\n```\nquery {\n  testField\n}\n```\n\n`Hello World!`が取れてたらOK!\n```\n{\n  "data": {\n    "testField": "Hello World!"\n  }\n}\n```\n\n今度は本題のDBに格納された値を取得したいので、User Modelを作成\n```bash\nrails g model User name:string email:string\n```\n\nmigrateして、usersテーブルを作成\n```bash\nrails db:migrate\n```\n\n`GraphQL`用のgenerateコマンドが準備されてるので、\nそれを使ってUser Typeを生成する\n```bash\nrails g graphql:object User id:Int! email:String\n```\n\nこれで`app/graphql/types/user_type.rb`が生成される\nそして、実際にDBの中にデータを入れるので`rails c`して\n```bash\nrails c\n```\n\n1件データを挿入\n```ruby\nUser.create!(id: 1, email: \'hoge@example.com\')\n\nUser.count # 1\n```\n\nDBに追加したUserを取得したいので、`app/graphql/types/query_type.rb`に下記を追加する\n```ruby\nfield :user, Types::UserType, null: false, resolve: ->(obj, args, ctx) { User.first }\n```\n\n`resolve`のところで、どのデータを返すのか、データを加工して返したいとかロジックを書くことができる\n実際にはログインしているUserを`ctx[:current_user]`とかで返すことになりそう\n`field`の書き方は`Class-Based API`になって変わったので、昔の書き方だとエラーが出る \n今回はサンプルなので、`User.first`で最初のUserを返すようにした\n\ngraphiqlの方で下記のqueryを実行\n```\nquery {\n  user {\n    id\n    email\n  }\n}\n```\n\n下記のようにちゃんとデータが取れてたら、OK..!\n```\n{\n  "data": {\n    "user": {\n      "id": 1,\n      "email": "hoge@example.com"\n    }\n  }\n}\n```\n\n参考\nこのYoutubeの解説動画が分かりやすかったです\n[Rails + GraphQL Tutorial - Building a GraphQL API Server](https://www.youtube.com/watch?v=DaznKqh5Ypk)\n',frontmatter:"title: GraphQL + RailsでDBからデータ取得までのメモ\ndate: 2018-11-02",fileName:"2018-11-02-graphql-rails-first-query"},{attributes:{title:"rbenvとnvmのコマンド早見表",date:"2018-10-28T00:00:00.000Z"},body:"\nいつも`rbenv`と`nvm`のコマンド何だっけ？ってググる事になるので、さっと打てるようにメモしておく。\n\n# rbenv\n\n```bash\n$ rbenv install -l    # インストール可能なバージョンを一覧表示\n$ rbenv versions      # 現在インストールされているバージョン表示\n$ rbenv install 2.2.0 # 指定バージョンをインストール\n$ rbenv global 2.2.0  # 指定バージョンをglobalにインストール\n$ rbenv local 2.2.0   # 指定バージョンをlocalにインストール\n$ rbenv rehash        # ruby -vでバージョン変わらない時とかに\n\n$ cd ~/.rbenv/plugins/ruby-build && git pull # ruby-buildを最新に(rbenv install -l 結果をupdateしたい時)\n```\n\n# nvm\n\n```bash\n$ nvm ls-remote            # インストール可能なバージョンを一覧表示\n$ nvm install v9.4.0       # 指定バージョンをインストール 切り替えまでするもよう\n$ nvm ls                   # 現在インストールされている全バージョンを確認\n$ nvm use v9.4.0           # 指定バージョンに変更\n$ nvm alias default v9.4.0 # PCのSystemのdefaultバージョンを指定\n```\n",frontmatter:"title: rbenvとnvmのコマンド早見表\ndate: 2018-10-28",fileName:"2018-10-28-commands-rbenv-and-nvm"},{attributes:{title:"1年分のDateオブジェクトを月単位の配列で取得する JS",date:"2018-10-20T00:00:00.000Z"},body:"\n文章で説明するのが難しいけど、  \n家計簿っぽいものを作ってると今日の日付から1年前までの月単位のDateオブジェクトの配列データが欲しかったりする。\n\n今日が、2018年10月20日だとすると\n```js\n[\n  Sat Oct 20 2018 00:00:00 GMT+0900 (日本標準時) {},\n  Thu Sep 20 2018 00:00:00 GMT+0900 (日本標準時) {},\n  Mon Aug 20 2018 00:00:00 GMT+0900 (日本標準時) {},\n  Fri Jul 20 2018 00:00:00 GMT+0900 (日本標準時) {},\n  Wed Jun 20 2018 00:00:00 GMT+0900 (日本標準時) {},\n  Sun May 20 2018 00:00:00 GMT+0900 (日本標準時) {},\n  Fri Apr 20 2018 00:00:00 GMT+0900 (日本標準時) {},\n  Tue Mar 20 2018 00:00:00 GMT+0900 (日本標準時) {},\n  Tue Feb 20 2018 00:00:00 GMT+0900 (日本標準時) {},\n  Sat Jan 20 2018 00:00:00 GMT+0900 (日本標準時) {},\n  Wed Dec 20 2017 00:00:00 GMT+0900 (日本標準時) {},\n  Mon Nov 20 2017 00:00:00 GMT+0900 (日本標準時) {}\n]\n```\nこんなDateオブジェクトが入った配列が欲しい時\n\nこれは下記で取得できる\n```js\n[...Array(12)].map((_, index) => {\n  const today = new Date();\n  return new Date(\n    today.getFullYear(),\n    today.getMonth() - index,\n    today.getDate()\n  );\n});\n```\n\n手順的には、\n- `[...Array(12)]`で `[undefined, undefined, ...]`が取れて、それをmapする(今回は12ヶ月分の配列が欲しいので)\n- `new Date(年, 月, 日)`で指定した日付のDateオブジェクトが取れるので、`today.getMonth() - index`で月をデクリメントしつつ\b返してあげる\n\n単純だけど、一瞬あれどうだっけ？となるのでメモ。\n",frontmatter:"title: 1年分のDateオブジェクトを月単位の配列で取得する JS \ndate: 2018-10-20",fileName:"2018-10-19-js-loop-between-month-ranges"},{attributes:{title:"highlight.jsのソースコードを改行させないCSS",date:"2018-10-16T00:00:00.000Z"},body:'\nこのブログは、<a href="https://highlightjs.org/" target="_blank">hightlight.js</a>を使ってソースコードのハイライト表示をしているけど、デフォルトだと横幅を超えると改行されるようになっていて、これを改行させずにスクロールして表示するようにしたいなぁと思ってた。そんな時のCSS。\n\n``` css\npre {\n  overflow: auto;\n  word-wrap: normal;\n  white-space: pre;\n}\n```\n\nこれでスクロールしてソースコード表示出来るように。\nただiOSだとスクロールに引っ掛かりがあるので、さらに `-webkit-overflow-scrolling: touch;` を入れてスムーズにスクロールするようにした。\n\n\n',frontmatter:"title: highlight.jsのソースコードを改行させないCSS\ndate: 2018-10-16",fileName:"2018-10-16-highlight-js-pre-code-word-wrap"},{attributes:{title:"JS 配列の中から対象オブジェクトを取り出す",date:"2018-10-07T00:00:00.000Z"},body:"\nJavaScriptで実装してると、配列の中がオブジェクトから成り立ってるという事がよくある\n\n```js\nconst list = [\n  { id: 1, name: 'ナオケル', sex: '男性' },\n  { id: 2, name: 'ジョーダン', sex: '男性' },\n  { id: 3, name: '花子', sex: '女性' }\n];\n```\n\nそしてこれを操作したい時に、\n`ある条件のオブジェクトだけを1つ取り出す`\nもしくは、\n`ある条件のオブジェクトだけにフィルタリングされた配列を取得する`\nということがままある\n\n実装自体はすごく簡単だけど、そんな時の備忘録として\n\n# 配列から指定のオブジェクトを1つだけ取り出す\n\n`find()`を使うと、配列の中から条件にあった最初の要素を1つ返してくれる\n見つからないときは`undifined`を返す\n\n<a href=\"https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Array/find\">Array.prototype.find()</a>\n\n``` js\nconst list = [\n  { id: 1, name: 'ナオケル', sex: '男性' },\n  { id: 2, name: 'ジョーダン', sex: '男性' },\n  { id: 3, name: '花子', sex: '女性' }\n];\n\nconst result = list.find(item => item.id === 2); // idが2の要素を返す\n\nconsole.log(result); // { id: 2, name: 'ジョーダン', sex: '男性' }\n```\n\n# 配列から指定のオブジェクトからなる配列を取得する\n\n`filter()`を使うと、関数の条件が`true`の要素からなる配列を返してくれる\n見つからないときは空の配列を返す\n\n<a href=\"https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Array/filter\">Array.prototype.filter()</a>\n\n``` js\nconst list = [\n  { id: 1, name: 'ナオケル', sex: '男性' },\n  { id: 2, name: 'ジョーダン', sex: '男性' },\n  { id: 3, name: '花子', sex: '女性' }\n];\n\nconst result = list.filter(item => item.sex === '男性'); // sexが男性の要素の配列を返す\n\n/*\n  [\n    { id: 1, name: 'ナオケル', sex: '男性' },\n    { id: 2, name: 'ジョーダン', sex: '男性' }\n  ]\n*/\nconsole.log(result);\n```\n\nかなり基礎的だけど、\n配列操作はかなり頻繁に起きうるのでしっかり固めたい。\n",frontmatter:"title: JS 配列の中から対象オブジェクトを取り出す\ndate: 2018-10-07",fileName:"2018-10-07-javascript-array-in-object"},{attributes:{title:"英語圏のサイトをヒットさせるGoogle検索",date:"2018-10-07T00:00:00.000Z"},body:'\n開発していて、バグに遭遇するとGoogle先生に頼ることは多い\nそんな時に日本語サイトでピンポイントにそのバグの解消法が載っていたらラッキーで、\nほとんどの場合、海外の`Stack Overflow`かGitHubの`Issue`で解決に導かれることが多い\n\nそうなると英語圏のググり力が大事になってくるけど、そんな時の「自分はこうやってます」メモ\n`いやいやもっと良い方法あるよ`って方は教えて頂けると有り難いです\n\n# 英語圏のサイトをヒットさせるGoogle検索\n\n英語圏でGoogle検索したい時、自分は下記のURLを開いて検索してる\n\n<a href="https://www.google.com/webhp?gl=us&hl=en&gws_rd=cr&pws=0" target="_blank" rel="noopener">\n  https://www.google.com/webhp?gl=us&hl=en&gws_rd=cr&pws=0\n</a>\n\n英語圏のクエリパラメーターが付いていて、基本的に英語サイトがヒットする\nバグの場合、エラー文言などで検索すると、高い確率で海外の`Stack Overflow`かGitHubの`Issue`が上位に表示される\n\n自分はこのURLをブックマークして、パッと開けるところに置いてる\n\nこの方法を知る前は、Google検索の`「設定」`から言語を`「英語」`に変えて検索したりしていた。\nこれでも英語はヒットするけど、操作がめんどくさいのと、英語圏に混じって日本語サイトが表示される事も多かったので、上記のURLに切り替えた\n\n# 公式サイトを見たい時も\n\n以前に比べて、公式のドキュメントを見る機会が圧倒的に多くなったと感じているけど、\n公式のドキュメント系も、このURLから検索するとだいたい1番最初にヒットしてくれる\n\n日本語圏で検索していると`「React」`なんかで検索しても、大量の日本語の入門記事がヒットして、肝心のReactの公式サイトはヒットしてくれない\n無いかもしれない公式サイトのリンクを求めて、「あってくれ!」と願いながらネットサーフィンすることさえある..(TT)\n\nという訳で、自分の中では結構重宝している検索方法の紹介でした\nちゃんちゃん\n',frontmatter:"title: 英語圏のサイトをヒットさせるGoogle検索\ndate: 2018-10-07",fileName:"2018-10-07-english-google-search"},{attributes:{title:"CSSアニメーションにおけるGPUをまとめてみた",date:"2018-10-05T00:00:00.000Z"},body:'\n最近、CSSアニメーションにおけるGPUについて調べる事があったので、まとめてみた。\n\n# GPUとCPU\nCSSアニメーションのパフォーマンスを改善する際に、GPU,CPUで処理する考え方が必要になってくる。  \n\n## GPUとは\n`GPU(Graphics Processing Unit)` ・・・ 画像処理を担当する部品の１つ  \n\n## CPUとは\n`CPU(Central Processing Unit)` ・・・ コンピュータの制御や演算や情報転送をつかさどる中枢部分\n\n# なぜGPUがパフォーマンス改善に役立つのか\n通常はCPUのみでアニメーションの演算や描画までを行っている。\nただ描画性能が高いGPUに描画処理を任せる事で、描画パフォーマンスが改善が期待出来る。  \nこのGPUに描画処理を任せる行為を、 `ハードウェアアクセラレーション` と呼んでいる。  \n\n## ブラウザにおけるハードウェアアクセラレーション\n\n通常ブラウザは、表示するページを1枚の絵として描画する。\nハードウェアアクセラレーションが適用された要素は、一枚の絵の上に別レイヤーを作る。\n処理を切り離してGPUで処理させることで、処理を最適化させる事ができるという仕組み。  \n\n<a href="http://jsfiddle.net/zFUVd/9/" target="_blank" rel="noopener">ハードウェアアクセラレーションが適用されているイメージ</a>を作っている方がいらっしゃった。\n\n## ハードウェアアクセラレーションを適用させるには\n\n下記のプロパティを使ったCSSアニメーションはGPU処理となる。  \n- opacity\n- translate\n- rotate\n- scale\n- 3D系プロパティ(translate3D, scale3d, rotate3dなど)\n\n# GPU処理されているか確認する\n\nChrome DevToolsの `Rendering` を見る事で実際にGPU処理されているか確認出来る。\n\n具体的に下記の確認できる。\n- 再描画されている要素\n- GPUレイヤーで生成されている要素\n- FPSなどの計測\n\n# topやleftなどのプロパティをGPU処理させるには\n\ntopやleftなどもGPUレイヤーで処理させる事が出来る。\n下記のプロパティの`いずれかを`一緒に当てると、`GPUレイヤーが生成されGPU処理`となる。  \n\n- backface-visibility: hidden;\n- transform: translateZ(0);\n- transform: translate3d(0, 0, 0);\n\nただやはり移動させる系のプロパティは、translateやtranslate3dを使った方がパフォーマンスには良いとのこと。  \n\n<a href="http://jsfiddle.net/eVtbM/30/" target="_blank" rel="noopener">GPU適用のExample</a>\n\n# 注意点: GPU処理もやりすぎると逆にパフォーマンスは落ちてしまう..\n\nとても良さそうに見えるGPU処理。\nだけどGPU処理もレイヤーを生成させて管理するコストがかかっている。\nやりすぎると逆にCPUへの負荷が高まりパフォーマンス低下を招いてしまうもよう。  \n\n`GPU処理によるデメリット`\n- アニメーションのチラツキ  \n- 動作が重くなる  \n- 描画崩壊  \n- ゴミがつく  \n\n※ハック的にGPUレイヤーを生成する `transform: translate3d(0, 0, 0);` などの指定も、多用しすぎると上記の現象が起きてしまうので、注意が必要そう。  \n\n具体的には、下記の点に気をつけると良さそうだった。  \n- GPU処理させている要素がたくさんありそうな時に注意する\n- GPU処理させる要素に子要素が必要な場合は出来る限り少なくする\n- 使用してない要素は、display:none;かGPU処理を切るようにする\n- bodyタグなど包括しているタグに、transform: translateZ(0);は指定しない\n- GPU処理もCPUへのコストがかかっている事を意識しておく\n- モバイルは特にブラウザの性能が低い事を知っておく\n\nGPUを考慮して、快適なCSSアニメーションライフを送っていきたいですね..!\n',frontmatter:"title: CSSアニメーションにおけるGPUをまとめてみた\ndate: 2018-10-05",fileName:"2018-10-05-gpu-cpu-css-animation"},{attributes:{title:"ブログ始めました(Nuxt.js + Markdown)",date:"2018-09-29T00:00:00.000Z"},body:'\n<img src="./images/2018-09-29/heading.png" width="100%">\n\n`Nuxt`の勉強がてら、`Nuxt + Markdown`でブログ作ってたら思った以上に時間かかった。。\n今度、その辺りの記事書けたらなと思います。\nとりあえずまだ下記の辺りが未対応なので、それが終わった辺りで。 \n\n- コードハイライト\n- 記事のCSS\n- RSSとかサイトマップとか\n- SNS投稿時の文言とか画像とか\n- 全体ソースのリファクタ\n- SP対応\n\nここでは開発で役立ったこととか、備忘録とか気づいた時に残していこうかなーと思います。\nゆるーくやっていけたらなと..!\n',frontmatter:"title: ブログ始めました(Nuxt.js + Markdown)\ndate: 2018-09-29",fileName:"2018-09-29-first-post"}],post:{attributes:{title:"",date:null},body:"",fileName:"",frontmatter:""}},serverRendered:!0}</script><script defer src="/blog/_nuxt/manifest.a5f9e150dfee106cb667.js"></script><script defer src="/blog/_nuxt/layouts/default.39f41fc80a7ca63b733a.js"></script><script defer src="/blog/_nuxt/pages/_slug.30db68fcf5770890f38f.js"></script><script defer src="/blog/_nuxt/vendor.9cd260a929ef240cc3c9.js"></script><script defer src="/blog/_nuxt/app.2d8371c12659f68c8806.js"></script>
  

